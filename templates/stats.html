<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Genre Statistics</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    window.addEventListener("DOMContentLoaded", () => {
      document.body.classList.add("fade-in");
    });
  </script>
  <style>
    .chart-container {
      width: 100%;
      max-width: 460px;
      margin: 0 auto 40px;
    }

    .genre-stat-list {
      display: grid;
      gap: 12px;
      padding: 0;
      list-style: none;
    }

    .genre-item {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(10px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
      padding: 12px 20px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      font-weight: 500;
      color: #333;
    }

    .no-data {
      text-align: center;
      color: #777;
      margin-top: 60px;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>

<div class="container">
  <h1 class="page-title">ðŸ“Š Genre Statistics</h1>

  {% if genre_counts|length > 0 %}
    <div class="chart-container">
      <canvas id="genreChart"></canvas>
    </div>

    <ul class="genre-stat-list">
      {% for genre, count in genre_counts %}
        <li class="genre-item">
          <span>{{ genre }}</span>
          <span>{{ count }}</span>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="no-data">No genre data to display. Add some movies first!</p>
  {% endif %}
</div>

{% if genre_counts|length > 0 %}
<script>
  const ctx = document.getElementById('genreChart').getContext('2d');
  const chart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: [{% for genre, count in genre_counts %}"{{ genre }}",{% endfor %}],
      datasets: [{
        data: [{% for genre, count in genre_counts %}{{ count }},{% endfor %}],
        backgroundColor: [
          '#0d6efd', '#6610f2', '#6f42c1', '#d63384',
          '#dc3545', '#fd7e14', '#ffc107', '#198754',
          '#20c997', '#0dcaf0', '#adb5bd', '#343a40'
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'bottom'
        },
        tooltip: {
          callbacks: {
            label: function(tooltipItem) {
              return tooltipItem.label + ": " + tooltipItem.raw;
            }
          }
        }
      }
    }
  });
</script>
{% endif %}

</body>
</html>
